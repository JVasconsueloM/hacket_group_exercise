import{c as O,i as F,k as P}from"./chunk-DC6MKQJR.js";import{$ as s,$a as f,Oa as w,Pa as g,Sa as y,Va as b,W as i,Za as v,_a as u,c as l,ca as h,fb as D,hb as d,z as k}from"./chunk-SVFPZVI5.js";var N=P`
  {
    vehicleOwnership {
      vehiclesAvailable
      percentage
    }
  }
`;var R=P`
  query {
    population {
      state
      year
      amount: populationAmount
    }
  }
`;var I=class o{constructor(t){this.apollo=t}executeQuery(t){return k(this.apollo.query({query:t})).then(e=>e.data)}static \u0275fac=function(e){return new(e||o)(s(F))};static \u0275prov=i({token:o,factory:o.\u0275fac,providedIn:"root"})};var C=class o{constructor(t){this.graphql=t}fetchVehicleOwnershipInHouseholdsData(){return l(this,null,function*(){return(yield this.graphql.executeQuery(N)).vehicleOwnership})}fetchPopulationData(){return l(this,null,function*(){return(yield this.graphql.executeQuery(R)).population})}static \u0275fac=function(e){return new(e||o)(s(I))};static \u0275prov=i({token:o,factory:o.\u0275fac,providedIn:"root"})};var x=class o{toChartData(t){let e=[],a=[];return t.forEach(r=>{e.push(r.vehiclesAvailable),a.push(r.percentage)}),{datasets:[{data:a}],labels:e}}static \u0275fac=function(e){return new(e||o)};static \u0275prov=i({token:o,factory:o.\u0275fac,providedIn:"root"})};var V=class o{constructor(t,e){this.repository=t;this.mapper=e}fetchVehicleOwnershipInHouseholdsData(){return l(this,null,function*(){let t=yield this.repository.fetchVehicleOwnershipInHouseholdsData();return this.transformData(t)})}transformData(t){return this.mapper.toChartData(t)}static \u0275fac=function(e){return new(e||o)(s(C),s(x))};static \u0275prov=i({token:o,factory:o.\u0275fac,providedIn:"root"})};var j=class o{constructor(t){this.vehicleOwnershipUseCase=t}datasets=y([]);chartOptions={responsive:!0};ngOnInit(){this.vehicleOwnershipUseCase.fetchVehicleOwnershipInHouseholdsData().then(({datasets:t})=>{this.datasets.set(t)})}static \u0275fac=function(e){return new(e||o)(g(V))};static \u0275cmp=h({type:o,selectors:[["app-vehicle-ownership-chart"]],standalone:!0,features:[d],decls:4,vars:3,consts:[["baseChart","",3,"datasets","options","type"]],template:function(e,a){e&1&&(v(0,"div")(1,"h5"),D(2,"Cars per household in USA 2021"),u(),f(3,"canvas",0),u()),e&2&&(w(3),b("datasets",a.datasets())("options",a.chartOptions)("type","pie"))},dependencies:[O],styles:["[_nghost-%COMP%]{width:200px}[_nghost-%COMP%]   h5[_ngcontent-%COMP%]{margin-bottom:32px}"]})};var M=class o{toChartData(t){let[e,a]=this.extractYearsAndStates(t),r=this.buildDataset(e,a,t),n=this.calculatePercentageDataset(a,r);return{labels:e,datasets:a.map(c=>({label:c,data:n[c]}))}}extractYearsAndStates(t){let e=Array.from(new Set(t.map(r=>r.year))).sort((r,n)=>Number(r)-Number(n)),a=Array.from(new Set(t.map(r=>r.state)));return[e,a]}buildDataset(t,e,a){let r={};return e.forEach(n=>{r[n]=Array(t.length).fill(0)}),a.forEach(n=>{let c=t.indexOf(n.year);c!==-1&&(r[n.state][c]=n.amount)}),r}calculatePercentageDataset(t,e){let a={};return t.forEach(r=>{a[r]=[];for(let n=0;n<e[r].length;n++)if(n===0)a[r].push(100);else{let c=e[r][n-1],Q=e[r][n],E=c?Q/c*100:0;a[r].push(E)}}),a}static \u0275fac=function(e){return new(e||o)};static \u0275prov=i({token:o,factory:o.\u0275fac,providedIn:"root"})};var S=class o{constructor(t,e){this.repository=t;this.mapper=e}fetchPopulationData(){return l(this,null,function*(){let t=yield this.repository.fetchPopulationData();return this.transformData(t)})}transformData(t){return this.mapper.toChartData(t)}static \u0275fac=function(e){return new(e||o)(s(C),s(M))};static \u0275prov=i({token:o,factory:o.\u0275fac,providedIn:"root"})};var A=class o{constructor(t){this.populationUseCase=t}labels=y([]);datasets=y([]);chartOptions={responsive:!0};ngOnInit(){this.populationUseCase.fetchPopulationData().then(({labels:t,datasets:e})=>{this.labels.set(t),this.datasets.set(e)})}static \u0275fac=function(e){return new(e||o)(g(S))};static \u0275cmp=h({type:o,selectors:[["app-population-chart"]],standalone:!0,features:[d],decls:6,vars:4,consts:[["baseChart","","width","100",3,"datasets","labels","options","type"]],template:function(e,a){e&1&&(v(0,"div")(1,"p"),D(2,"Population of "),v(3,"strong"),D(4,"Alabama, Florida and California"),u()(),f(5,"canvas",0),u()),e&2&&(w(5),b("datasets",a.datasets())("labels",a.labels())("options",a.chartOptions)("type","line"))},dependencies:[O],styles:["[_nghost-%COMP%]{width:550px}[_nghost-%COMP%]   p[_ngcontent-%COMP%]{font-size:13px;margin-bottom:32px}@media (max-width: 850px){[_nghost-%COMP%]{width:100%}}"]})};var U=class o{static \u0275fac=function(e){return new(e||o)};static \u0275cmp=h({type:o,selectors:[["app-dashboard"]],standalone:!0,features:[d],decls:2,vars:0,template:function(e,a){e&1&&f(0,"app-vehicle-ownership-chart")(1,"app-population-chart")},dependencies:[j,A],styles:["[_nghost-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;gap:16px}@media (max-width: 600px){[_nghost-%COMP%]{flex-direction:column;gap:64px}}"]})};export{U as default};
